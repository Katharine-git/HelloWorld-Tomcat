---
 - name: Deploy war
   hosts: localhost
   tasks:
     - name: Stop tomcat
       shell: nohup sh /opt/tomcat/bin/shutdown.sh &
       become: true
       
     - name: Delete old war
       shell: rm -rf /opt/tomcat/webapps/hello-world-war-1.0.0.war  state=absent
     
     - name: Push war to artifactory
       uri:
         url: "http://localhost:8081/artifactory/webapp/#/artifacts/browse/tree/General/libs-release-local/demo-war/hello-world-war-1.0.0.war"
         method: POST
         src: "/var/lib/jenkins/workspace/ansible-tomcat-deploy/target/hello-world-war-1.0.0.war"
         user: "admin"
         password: "Jfrog@123"
         force_basic_auth: yes

#     - name: download war
#       copy:
#         src: /var/lib/jenkins/workspace/ansible-tomcat-deploy/target/hello-world-war-1.0.0
#         dest: http://localhost:8081/artifactory/webapp/#/artifacts/browse/tree/General/libs-release-local/demo-war/hello-world-war-1.0.0.war

#     - name: Start Tomcat
#       shell: nohup sh /opt/tomcat/bin/startup.sh
#       become: true
- name: POST from contents of remote file
  uri:
    url: "https://httpbin.org/post"
    method: POST
    src: /path/to/my/file.json
    remote_src: true