---
 - name: Deploy war
   hosts: localhost
   tasks:
     - name: Stop tomcat
       shell: nohup sh /opt/tomcat/bin/shutdown.sh &
       become: true
       
     - name: Delete old war
       shell: rm -rf /opt/tomcat/webapps/hello-world-war-1.0.0.war  state=absent

     - name: download war
       copy:
         src: /var/lib/jenkins/workspace/ansible-tomcat-deploy/target/hello-world-war-1.0.0
         dest: /opt/tomcat/webapps/

     - name: Start Tomcat
       shell: nohup sh /opt/tomcat/bin/startup.sh
       become: true
